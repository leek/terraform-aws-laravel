# Health check endpoint for ALB
# Simple nginx-level health check that doesn't require PHP/Laravel
location = /health {
    auth_basic off;
    access_log off;
    return 200 "healthy\n";
    add_header Content-Type text/plain;
}

# Laravel application health check (Route53)
# Bypasses HTTP Basic Auth and routes to Laravel
# Works in both PHP-FPM and Octane modes:
# - PHP-FPM: /index.php is caught by location ~ \.php$ and executed via fastcgi_pass
# - Octane: /index.php is caught by location /index.php which proxies to @octane
location = /up {
    auth_basic off;
    access_log off;
    # Use a non-existent file to force fallback to index.php
    # Laravel will see the original /up URI and route it correctly
    try_files /nonexistent /index.php?$query_string;
}
